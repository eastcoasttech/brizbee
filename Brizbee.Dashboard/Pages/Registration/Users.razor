@page "/registration/users"

@using Brizbee.Dashboard.Services
@using Brizbee.Dashboard.Serialization
@using Brizbee.Common.Security

@inject NavigationManager NavigationManager
@inject LocalStorageService localStorageService
@inject SharedService sharedService
@inject UserService userService
@inject CommitService commitService
@inject PunchService punchService
@inject CustomerService customerService
@inject TaskService taskService
@inject TaskTemplateService taskTemplateService
@inject JobService jobService
@inject RateService rateService
@inject OrganizationService organizationService
@inject TimesheetEntryService timesheetEntryService
@inject QBDInventoryItemService qbdInventoryItemService
@inject QBDInventoryItemSyncService qbdInventoryItemSyncService
@inject QBDInventoryConsumptionService qbdInventoryConsumptionService
@inject QBDInventoryConsumptionSyncService qbdInventoryConsumptionSyncService
@inject ExportService exportService

<div class="container-fluid fadeIn" style="min-height: 50vh;">
    <div class="row" style="margin-top: 2em; margin-bottom: 2em;">
        <div class="col-md-6 col-md-offset-3 col-sm-12 col-xs-12">
            <div class="panel panel-default" style="margin-bottom: 5px;">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-md-9">
                            Add Your Employees
                        </div>
                        <div class="col-md-3 text-right">
                            Step 3 of 3
                        </div>
                    </div>
                </div>
                <div class="panel-body" style="padding: 35px;">
                    <div class="fadeIn" ng-show="step.name == 'users'">
                        <p>Finally, let's add your employees. You can always add more later if you don't want to do this right now.</p>

                        <ul class="list-unstyled fadeIn" style="padding-top: 10px;" ng-show="new.users.length > 0">
                            <li style="margin-top: 5px; margin-bottom: 5px; font-weight: bold;">Saved Employees</li>
                            <li ng-repeat="user in new.users" class="fadeIn" style="margin-top: 5px; margin-bottom: 5px;">
                                <i class="fa fa-check text-success" style="padding-right: 5px;"></i>
                                {{user.Name}} <span ng-show="user.EmailAddress">&ndash; {{user.EmailAddress}}</span> &ndash; {{user.Pin}}
                            </li>
                        </ul>

                        <hr />

                        <form name="userForm" ng-submit="saveUser()" style="margin-bottom: 30px;" autocomplete="off" novalidate>
                            <div class="form-group">
                                <label>Employee Name</label>
                                <input type="text" id="new_user_name" name="new_user_name" class="form-control" ng-model="new.user.Name" ng-disabled="working.user" required />
                            </div>
                            <div class="form-group">
                                <label>Email Address (optional)</label>
                                <input type="email" name="new_user_email_address" class="form-control" ng-model="new.user.EmailAddress" ng-disabled="working.user" />
                            </div>
                            <div class="form-group">
                                <label>PIN Number</label>
                                <input type="text" name="new_user_pin" class="form-control form-control-number" style="width: 20%;" ng-model="new.user.Pin" minlength="4" maxlength="9" ng-disabled="working.user" required />
                                <p class="help-block">This 4+ digit code is private and unique to each employee.</p>
                            </div>
                            <button type="submit" class="btn btn-primary" style="margin-right: 10px;" ng-disabled="working.user || userForm.$invalid">Add Employee<i class="fa fa-spinner fa-spin fa-fw" ng-show="working.user"></i></button>
                            <a href="#!/jobs" class="btn btn-primary">Continue to BRIZBEE</a>
                        </form>
                    </div>
                </div>
            </div>
            <p class="text-muted" style="margin-top: 10px;">Need help? Email us at <a href="mailto:sales@brizbee.com">sales@brizbee.com</a> and we'll help you get started.</p>
        </div>
    </div>
</div>

@code {
    private bool loading = true;
    private bool working = false;
}
